diff -Nur sshguard-1.5/configure.ac sshguard-1.5-DNP/configure.ac
--- sshguard-1.5/configure.ac	2011-02-09 07:01:47.000000000 -0500
+++ sshguard-1.5-DNP/configure.ac	2012-01-09 22:33:37.000000000 -0500
@@ -65,7 +65,7 @@
 
 #   --with-firewall     for setting what blocking backend to use
 AC_ARG_WITH(firewall,
-[  --with-firewall=< pf | ipfw | iptables | ipfilter | hosts | aix | null >
+[  --with-firewall=< pf | ipfw | iptables | ipfilter | hosts | aix | null | dnp >
                           Select the firewall backend],
 [
  FWALLSDIR="src/fwalls"
@@ -145,6 +145,10 @@
         cp $FWALLSDIR/command_null.h $FWALLSDIR/command.h
         usenull=true
         ;;
+     dnp)
+        cp $FWALLSDIR/command_DNP.h $FWALLSDIR/command.h
+        usednp=true
+        ;;
      *)
         echo "Choose a valid firewall backend (see --help)"
         exit 1
@@ -170,6 +174,8 @@
 AM_CONDITIONAL(FWALL_PF, test x$usepf = xtrue)
 # NULL chosen
 AM_CONDITIONAL(FWALL_NULL, test x$usenull = xtrue)
+# DNP chosen
+AM_CONDITIONAL(FWALL_DNP, test x$usednp = xtrue)
 
 
 ##          CUSTOM SETTINGS FOR PATHS
diff -Nur sshguard-1.5/src/fwalls/command_DNP.h sshguard-1.5-DNP/src/fwalls/command_DNP.h
--- sshguard-1.5/src/fwalls/command_DNP.h	1969-12-31 19:00:00.000000000 -0500
+++ sshguard-1.5-DNP/src/fwalls/command_DNP.h	2012-01-09 22:31:16.000000000 -0500
@@ -0,0 +1,13 @@
+#ifndef COMMAND_H
+#define COMMAND_H
+
+/* user-define backend DNP */
+#include "../config.h"
+
+#define COMMAND_INIT       "/tmp/dnp-fw/fw-cmd-init.sh"
+#define COMMAND_FIN        ""
+#define COMMAND_BLOCK      "/tmp/dnp-fw/fw-cmd-block.sh $SSHG_ADDR"
+#define COMMAND_RELEASE    "/tmp/dnp-fw/fw-cmd-release.sh $SSHG_ADDR"
+#define COMMAND_FLUSH      "/tmp/dnp-fw/fw-cmd-flush.sh"
+        
+#endif
